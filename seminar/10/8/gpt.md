–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∑–∞–¥–∞—á—É:

---

## üìò –£—Å–ª–æ–≤–∏–µ:

–î–∞–Ω –º–∞—Å—Å–∏–≤ `a[]` –∏–∑ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ **–ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫** `[l..r]`, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ:

```
sum(l..r) √ó min(l..r)
```

–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ.

---

## üß† –ò–¥–µ—è —Ä–µ—à–µ–Ω–∏—è:

–≠—Ç–æ –∑–∞–¥–∞—á–∞ **–ø–æ–¥–æ–±–Ω–∞ "Largest Rectangle in Histogram"**, –Ω–æ —Å twist: –≤–º–µ—Å—Ç–æ –ø–ª–æ—â–∞–¥–∏ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞, –º—ã —Ö–æ—Ç–∏–º –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å:

> —Å—É–º–º–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ √ó –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ —ç—Ç–æ–º –æ—Ç—Ä–µ–∑–∫–µ

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ `a[i]`, –º—ã —Ö–æ—Ç–∏–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å:

* –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Ç—Ä–µ–∑–æ–∫ `[L..R]`, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º `a[i]` ‚Äî **–º–∏–Ω–∏–º—É–º**,
* –ø–æ—Å—á–∏—Ç–∞—Ç—å `sum[L..R] √ó a[i]` ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –º–∞–∫—Å–∏–º—É–º.

---

## üîß –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

### –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏:

1. **–ü—Ä–µ—Ñ–∏–∫—Å–Ω–∞—è —Å—É–º–º–∞:** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—É–º–º—ã –æ—Ç—Ä–µ–∑–∫–∞ `[L..R]`
2. **–ú–æ–Ω–æ—Ç–æ–Ω–Ω—ã–π —Å—Ç–µ–∫:** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ `i` –Ω–∞–π–¥—ë–º:

    * `left[i]`: –±–ª–∏–∂–∞–π—à–∏–π —Å–ª–µ–≤–∞ –∏–Ω–¥–µ–∫—Å, –≥–¥–µ —ç–ª–µ–º–µ–Ω—Ç **–º–µ–Ω—å—à–µ** `a[i]`,
    * `right[i]`: –±–ª–∏–∂–∞–π—à–∏–π —Å–ø—Ä–∞–≤–∞ –∏–Ω–¥–µ–∫—Å, –≥–¥–µ —ç–ª–µ–º–µ–Ω—Ç **–º–µ–Ω—å—à–µ** `a[i]`.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ `[left[i]+1, right[i]-1]`, `a[i]` ‚Äî –º–∏–Ω–∏–º—É–º.

---

## ‚úÖ Java-–∫–æ–¥ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º:

```java
import java.util.*;

public class MaxProductSegment {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        int n = sc.nextInt();
        int[] a = new int[n];
        long[] prefixSum = new long[n + 1];

        for (int i = 0; i < n; i++) {
            a[i] = sc.nextInt();
            prefixSum[i + 1] = prefixSum[i] + a[i]; // –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–µ —Å—É–º–º—ã
        }

        int[] left = new int[n];
        int[] right = new int[n];

        // –ú–æ–Ω–æ—Ç–æ–Ω–Ω—ã–π —Å—Ç–µ–∫ –¥–ª—è left[]
        Deque<Integer> stack = new ArrayDeque<>();
        for (int i = 0; i < n; i++) {
            while (!stack.isEmpty() && a[stack.peek()] >= a[i]) {
                stack.pop();
            }
            left[i] = stack.isEmpty() ? -1 : stack.peek();
            stack.push(i);
        }

        // –ú–æ–Ω–æ—Ç–æ–Ω–Ω—ã–π —Å—Ç–µ–∫ –¥–ª—è right[]
        stack.clear();
        for (int i = n - 1; i >= 0; i--) {
            while (!stack.isEmpty() && a[stack.peek()] >= a[i]) {
                stack.pop();
            }
            right[i] = stack.isEmpty() ? n : stack.peek();
            stack.push(i);
        }

        // –í—ã—á–∏—Å–ª—è–µ–º –º–∞–∫—Å–∏–º—É–º (—Å—É–º–º–∞ √ó –º–∏–Ω–∏–º—É–º)
        long maxProduct = 0;
        int bestL = 0, bestR = 0;

        for (int i = 0; i < n; i++) {
            int l = left[i] + 1;
            int r = right[i] - 1;

            long sum = prefixSum[r + 1] - prefixSum[l];
            long product = sum * a[i];

            if (product > maxProduct) {
                maxProduct = product;
                bestL = l;
                bestR = r;
            }
        }

        System.out.println("Max product: " + maxProduct);
        System.out.println("Segment: [" + bestL + ", " + bestR + "]");
    }
}
```

---

## üß™ –ü—Ä–∏–º–µ—Ä:

–í–≤–æ–¥:

```
6
3 1 6 4 5 2
```

–ü–æ—è—Å–Ω–µ–Ω–∏–µ:

* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ `[2, 4]` (—Ç–æ –µ—Å—Ç—å —á–∏—Å–ª–∞ `6, 4, 5`)
* –°—É–º–º–∞ = `15`, –º–∏–Ω–∏–º—É–º = `4`
* –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ = `15 √ó 4 = 60`

–í—ã–≤–æ–¥:

```
Max product: 60
Segment: [2, 4]
```

---

## ‚è± –°–ª–æ–∂–Ω–æ—Å—Ç—å:

* –ü—Ä–µ—Ñ–∏–∫—Å–Ω—ã–µ —Å—É–º–º—ã: O(n)
* –ú–æ–Ω–æ—Ç–æ–Ω–Ω—ã–µ —Å—Ç–µ–∫–∏: O(n)
* –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –º–∞—Å—Å–∏–≤—É: O(n)

‚û°Ô∏è –û–±—â–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: **O(n)** ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–∞–∂–µ –ø—Ä–∏ `n` –¥–æ `10^5`.

---

–•–æ—á–µ—à—å, —á—Ç–æ–±—ã –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ç–∞–∫–∂–µ –≤—ã–≤–æ–¥–∏–ª–∞ —Å–∞–º –ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫ (–Ω–µ —Ç–æ–ª—å–∫–æ –∏–Ω–¥–µ–∫—Å—ã)?
