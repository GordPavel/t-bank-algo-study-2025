–î–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏:

> –ï—Å—Ç—å –ø—É—Å—Ç–æ–π –≥—Ä–∞—Ñ. –î–µ–ª–∞—é—Ç –¥–≤–∞ –≤–∏–¥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤:
>
> 1. –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–±—Ä–æ –º–µ–∂–¥—É –≤–µ—Ä—à–∏–Ω–∞–º–∏ `u` –∏ `v`.
> 2. –ù–∞–π—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ **–∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–≤—è–∑–Ω–æ—Å—Ç–∏**, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è **–¥–µ—Ä–µ–≤—å—è–º–∏**.

–Ω—É–∂–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—â–∞—è **–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–≤—è–∑–Ω–æ—Å—Ç–∏**, **—á–∏—Å–ª–æ —Ä—ë–±–µ—Ä** –≤ –Ω–∏—Ö, –∏ –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –±—ã—Å—Ç—Ä–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–∞–∂–¥–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ **–¥–µ—Ä–µ–≤–æ–º**.

---

## üìö –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–µ—Ä–µ–≤–æ –≤ –≥—Ä–∞—Ñ–µ?

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å–≤—è–∑–Ω–æ—Å—Ç–∏ ‚Äî **–¥–µ—Ä–µ–≤–æ**, –µ—Å–ª–∏:

* –æ–Ω–∞ **—Å–≤—è–∑–Ω–∞**,
* **–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ü–∏–∫–ª–æ–≤**.

üëâ –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –Ω–∞ `k` –≤–µ—Ä—à–∏–Ω–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–æ–≤–Ω–æ `k-1` —Ä—ë–±–µ—Ä.

---

## üß† –ò–¥–µ—è —Ä–µ—à–µ–Ω–∏—è:

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º **DSU (Disjoint Set Union)** —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è–º–∏:

* `size[root]` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ,
* `edges[root]` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—ë–±–µ—Ä –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ,
* `isTree[root]` ‚Äî —Ñ–ª–∞–≥: —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –¥–µ—Ä–µ–≤–æ–º.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `treeComponentsCount`, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—â–∞—è –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —è–≤–ª—è—é—â–∏—Ö—Å—è –¥–µ—Ä–µ–≤—å—è–º–∏.

---

## ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Java:

```java
public class DisjointSet {
    private int[] parent;
    private int[] size;
    private int[] edges;
    private boolean[] isTree;
    private int treeComponentsCount;

    public DisjointSet(int n) {
        parent = new int[n];
        size = new int[n];
        edges = new int[n];
        isTree = new boolean[n];
        treeComponentsCount = n;

        for (int i = 0; i < n; i++) {
            parent[i] = i;
            size[i] = 1;
            edges[i] = 0;
            isTree[i] = true; // –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ —Å–∞–º–∞ –ø–æ —Å–µ–±–µ ‚Äî –¥–µ—Ä–µ–≤–æ
        }
    }

    public int find(int x) {
        if (x != parent[x]) {
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    public void addEdge(int u, int v) {
        int ru = find(u);
        int rv = find(v);

        if (ru == rv) {
            // –†—ë–±—Ä–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, —Ü–∏–∫–ª
            edges[ru]++;
            if (isTree[ru] && edges[ru] >= size[ru]) {
                isTree[ru] = false;
                treeComponentsCount--;
            }
        } else {
            // –û–±—ä–µ–¥–∏–Ω—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
            int newSize = size[ru] + size[rv];
            int newEdges = edges[ru] + edges[rv] + 1;
            boolean newIsTree = isTree[ru] && isTree[rv] && (newEdges == newSize - 1);

            // –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ —Ä–∞–∑–º–µ—Ä—É
            if (size[ru] < size[rv]) {
                int temp = ru;
                ru = rv;
                rv = temp;
            }

            parent[rv] = ru;
            size[ru] = newSize;
            edges[ru] = newEdges;
            if (isTree[ru]) treeComponentsCount--;
            if (isTree[rv]) treeComponentsCount--;
            isTree[ru] = newIsTree;
            if (newIsTree) treeComponentsCount++;
        }
    }

    public int getTreeComponentsCount() {
        return treeComponentsCount;
    }
}
```

---

## üß™ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```java
public class Main {
    public static void main(String[] args) {
        int n = 6;
        DisjointSet dsu = new DisjointSet(n);

        dsu.addEdge(0, 1); // –¥–µ—Ä–µ–≤–æ
        dsu.addEdge(2, 3); // –¥–µ—Ä–µ–≤–æ
        dsu.addEdge(1, 2); // –æ–±—ä–µ–¥–∏–Ω—è–µ–º –¥–≤–∞ –¥–µ—Ä–µ–≤–∞ –≤ –æ–¥–Ω–æ ‚Äî —Ç–æ–∂–µ –¥–µ—Ä–µ–≤–æ
        dsu.addEdge(3, 0); // –¥–æ–±–∞–≤–∏–ª–∏ —Ü–∏–∫–ª ‚Äî –±–æ–ª—å—à–µ –Ω–µ –¥–µ—Ä–µ–≤–æ
        dsu.addEdge(4, 5); // –¥–µ—Ä–µ–≤–æ

        System.out.println("Number of tree components: " + dsu.getTreeComponentsCount()); // 1
    }
}
```

---

### üì§ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

1. `{0,1}` ‚Äî –¥–µ—Ä–µ–≤–æ.
2. `{2,3}` ‚Äî –¥–µ—Ä–µ–≤–æ.
3. –ø–æ—Å–ª–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è `1-2`, –ø–æ–ª—É—á–∞–µ–º `{0,1,2,3}` ‚Äî —Ä–∞–∑–º–µ—Ä 4, 3 —Ä–µ–±—Ä–∞ ‚Äî –µ—â—ë –¥–µ—Ä–µ–≤–æ.
4. –ø–æ—Å–ª–µ `3-0` ‚Äî —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è 4 —Ä–µ–±—Ä–∞, **–Ω–µ –¥–µ—Ä–µ–≤–æ**.
5. `{4,5}` ‚Äî –µ—â—ë –æ–¥–Ω–æ –¥–µ—Ä–µ–≤–æ.

–û—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, —è–≤–ª—è—é—â–∞—è—Å—è –¥–µ—Ä–µ–≤–æ–º: `{4,5}`.

---

–•–æ—á–µ—à—å, —á—Ç–æ–±—ã —ç—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–∏–Ω–∏–º–∞–ª–∞ –∑–∞–ø—Ä–æ—Å—ã –∏–∑ –∫–æ–Ω—Å–æ–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
ADD 1 2
COUNT
```
