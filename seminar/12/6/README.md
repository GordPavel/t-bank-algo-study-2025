# Реализуйте решето Эратосфена за O(n).

Для реализации решета Эратосфена с асимптотикой $$O(n)$$ (линейное решето) используется идея, что каждое составное число помечается только по своему минимальному простому делителю. Для этого хранят массив простых чисел и для каждого числа — его минимальный простой делитель.

Вот пример такой реализации на Java:

```java
import java.util.*;

public class LinearSieve {

    public static void main(String[] args) {
        printAllSimpleNumbersUnder(100);
    }

    private static void printAllSimpleNumbersUnder(int n) {
        int[] lp = new int[n + 1]; // lp[x] — минимальный простой делитель числа x
        List<Integer> primes = new ArrayList<>();

        for (int i = 2; i <= n; i++) {
            if (lp[i] == 0) {
                lp[i] = i;
                primes.add(i);
            }
            for (int p : primes) {
                if (p > lp[i] || i * p > n)
                    break;
                lp[i * p] = p;
            }
        }

        // Вывод всех простых чисел
        for (int p : primes) {
            System.out.print(p + " ");
        }
    }
}
```

**Объяснение:**
- Массив `lp` хранит минимальный простой делитель для каждого числа.
- Список `primes` содержит все найденные простые числа.
- Для каждого числа $$i$$ перебираются простые $$p$$ не больше $$lp[i]$$, и помечается число $$i \times p$$.
- Каждое число помечается только по своему минимальному простому делителю, что гарантирует асимптотику $$O(n)$$[2][4].

Такой подход и есть "решето Эратосфена за $$O(n)$$" — линейное решето.
