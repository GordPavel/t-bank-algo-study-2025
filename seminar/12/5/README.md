# Докажите, что обычное решето Эратосфена работает за O(n log log n).

Алгоритм

```java
import java.util.Arrays;

public class SieveOfEratosthenes {

    public static void main(String[] args) {
        printAllSimpleNumbersUnder(
            100
        );
    }

    private static void printAllSimpleNumbersUnder(int n) {
        boolean[] isPrime = new boolean[n + 1];
        Arrays.fill(isPrime, true); // Считаем все числа простыми

        isPrime[0] = false;
        isPrime[1] = false;

        for (int i = 2; i * i <= n; i++) {
            if (isPrime[i]) {
                for (int j = i * i; j <= n; j += i) {
                    isPrime[j] = false;
                }
            }
        }

        // Вывод всех простых чисел
        for (int i = 2; i <= n; i++) {
            if (isPrime[i]) {
                System.out.print(i + " ");
            }
        }
    }
}

```

Сложность времени стандартного решета Эратосфена $$O(n \log \log n)$$ возникает из анализа количества операций маркировки составных чисел. Вот ключевые шаги доказательства:

1. **Алгоритмическая структура**  
   Для каждого простого числа $$p$$ алгоритм маркирует все кратные $$p$$ начиная с $$p^2$$. 
   Внешний цикл выполняется для $$p \leq \sqrt{n}$$, но внутренний цикл обрабатывает кратные до $$n$$.

2. **Суммарное количество операций**  
   Общее число итераций определяется суммой:
   $$
   \sum_{p \leq n} \left\lfloor \frac{n}{p} \right\rfloor \approx n \sum_{p \leq n} \frac{1}{p}
   $$
   где сумма берется по всем простым $$p \leq n$$.

3. **Асимптотика суммы обратных простых**  
   Согласно теореме Мертенса, сумма обратных значений простых чисел до $$n$$ оценивается как:
   $$
   \sum_{p \leq n} \frac{1}{p} = \log \log n + M + o(1),
   $$
   где $$M$$ — константа Мейсселя-Мертенса ($$≈0.261$$). Это даёт:
   $$
   n \sum_{p \leq n} \frac{1}{p} = O(n \log \log n).
   $$

4. **Оптимизация до $$\sqrt{n}$$**  
   Проверка делителей до $$\sqrt{n}$$ (вместо $$n$$) сокращает внешний цикл, но не влияет на асимптотику, так как основная работа выполняется при маркировке кратных малых простых.

5. **Логарифмическая база**  
   В Big O нотации база логарифма не имеет значения, так как $$\log_b x = \frac{\ln x}{\ln b}$$, и константа поглощается. Однако исторически используется натуральный логарифм из-за связи с интегральным логарифмом в теории чисел[4].

**Пример расчета**  
Для $$n = 10^6$$:
- Количество простых чисел до $$n$$: $$\approx \frac{n}{\ln n} = 72,382$$ (теорема о простых числах).
- Сумма $$\sum \frac{1}{p}$$ для $$p \leq 10^6$$: $$\approx \log \log 10^6 ≈ 3.03$$.
- Общее количество операций: $$10^6 \times 3.03 ≈ 3.03 \times 10^6$$, что соответствует $$O(n \log \log n)$$.

