Ускорение до O(N‾‾√)
Утверждение:
Пусть N=a×b
, причем a≤b
. Тогда a≤N‾‾√≤b
.

Доказательство:
если a≤b<N‾‾√
, то ab≤b2<N
, но ab=N
. А если N‾‾√<a≤b
, то N<a2≤ab
, но ab=N
.

Иными словами, если число N
равно произведению двух других, то одно из них не больше корня из N
, а другое не меньше корня из N
.

Из этого следует, что если число N
не делится ни на одно из чисел 2,3,4,…,⌊N‾‾√⌋
, то оно не делится и ни на одно из чисел ⌈N‾‾√⌉+1,…,N−2,N−1
, так как если есть делитель больше корня (не равный N
), то есть делитель и меньше корня (не равный 1
). Поэтому в цикле for достаточно проверять числа не до N
, а до корня.